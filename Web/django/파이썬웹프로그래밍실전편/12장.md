# 12장 - 실전 프로그램 개발 - 콘텐츠 편집 기능(Bookmark, Blog 앱)
- 콘텐츠의 생성 및 변경 기능을 작성한다.
- 다음과 같은 권한 부여 요구 사항을 적용한다.
    - 콘텐츠 Read: 모든 사용자
    - 콘텐츠 Create: 로그인한 사용자만
    - 콘텐츠 Update, Delete: 그 콘텐츠를 생성한 사용자만

# 12.1 애플리케이션 설계하기
- 콘텐츠 편집 기능을 개발
- CRUD 기능은 테이블 단위로 처리되므로, 테이블에 대한 CRUD 기능을 구현하는 것이 핵심

# 12.1.1 화면 UI 설계
- 콘텐츠 편집은 페이지 상단의 [ADD]와 [Change]메뉴에 구현한다.
- CreateView 및 UpdateView에서 자동으로 만들어준 폼을 사용한다.

# 12.1.2 테이블 설계
- 콘텐츠의 소유자를 고려해야한다.
- 각 콘텐츠 테이블별로 소유자 필드가 필요하다.
- 표 12-1 테이블 설계 - 기존 테이블 변경(Bookmark 모델 클래스)

| 필드명 | 타입             | 제약 조건          | 설명          |
|--------|------------------|--------------------|---------------|
| Id     | Integer          | PK, Auto Increment | 기본 키       |
| Title  | CharField(100)   | Blank, Null        | 북마크 제목   |
| url    | URLField         | Unique             | 북마크 URL    |
| owner  | ForeignKey(User) | Null               | 북마크 소유자 | 

- 표 12-2 테이블 설계 - 기존 테이블 변경(Post 모델 클래스)

| 필드명      | 타입             | 제약 조건          | 설명                   |
|-------------|------------------|--------------------|------------------------|
| Id          | Integer          | PK, Auto Increment | 기본 키                |
| title       | CharField(50)    |                    | 포스트 제목            |
| slug        | SlugField(50)    | Unique             | 포스트 제목 별칭       |
| description | CharField(100)   | Blank              | 포스트 내용 한 줄 설명 |
| content     | TextField        |                    | 포스트 내용 기록       |
| create_date | DateTimeField    | auto_now_add       | 포스트를 생성한 날짜   |
| modify_date | DateTimeField    | auto_now           | 포스트를 수정한 날짜   |
| owner       | ForeignKey(User) | Null               | 포스트 소유자          |

# 12.1.3 URL 설계
- 콘텐츠별로 생성, 수정, 삭제 작업을 요청할 수 있는 URl이 필요하다.
- 기존 앱에서 정의한 URLconf에 다음 URl을 추가해 설계한다.
    - Create(생성)
    - Update(수정)
    - Delete(삭제)
    - Change(변경 대상 리스트)
- 표 12-3 URL 설계 - 기존 URL 변경(북마크 앱)

| URL 패턴              | 뷰 이름                        | 템플릿 파일명                |
|-----------------------|--------------------------------|------------------------------|
| /bookmark/            | BookmarkLV(ListView)           | bookmark_list.html           |
| /bookmark/99/         | BookmarkDV(DetailView)         | bookmark_detail.html         |
| /bookmark/add/*       | BookmarkCreateView(CreateView) | bookmark_form.html           |
| /bookmark/change/     | BookmarkChangeLV(ListView)     | bookmark_change_list.html    |
| /bookmark/99/update/* | BookmarkUpdateView(UpdateView) | bookmark_form.html           |
| /bookmark/99/delete   | BookmarkDeleteView(DeleteView) | bookmark_confirm_delete.html |
- \* /add/와 /update/에 대한 템플릿 파일은 동일함

- 표 12-4 URL 설계 - 기존 URL 변경(블로그 앱)

| URL 패턴                   | 뷰 이름                    | 템플릿 파일명            |
|----------------------------|----------------------------|--------------------------|
| /blog/                     | PostLV(ListView)           | post_all.html            |
| /blog/post/                | PostLV(ListView)           | post_all.html            |
| /blog/post/django-example/ | PostDV(DetailView)         | post_detail.html         |
| /blog/archive/             | PostAV(ArchiveIndexView)   | post_archive.html        |
| /blog/2012/                | PostYAV(YearArchiveView)   | post_archive_year.html   |
| /blog/2012/nov             | PostMAV(MonthArchiveView)  | post_archive_month.html  |
| /blog/2012/nov/10/         | PostDAV(DayArchiveView)    | post_archive_day.html    |
| /blog/today/               | PostTAV(TodayArchiveView)  | post_archive_day.html    |
| /blog/add/*                | PostCreateView(CreateView) | post_form.html           |
| /blog/change/              | PostChangeLV(ListView)     | post_change_list.html    |
| /blog/99/update/*          | PostUpdateView(UpdateView) | post_form.html           |
| /blog/99/delete/           | PostDeleteView(DeleteView) | post_confirm_delete.html |
- \* /add/와 /update/에 대한 템플릿 파일은 동일함

# 12.1.4 작업/코딩 순서
- 작업 순서는 다음과 같다.
- 표 12-5 작업/코딩 순서 - 북마크/블로그 앱 편집

| 작업 순서        | 관련 명령/파일     | 필요한 작업 내용                   |
|------------------|--------------------|------------------------------------|
| 뼈대 만들기      | startproject       | (2장에서 완료함)                   |
|                  | settings.py        |                                    |
|                  | migrate            |                                    |
|                  | createsuperuser    |                                    |
|                  | startapp           | (변경 사항 없음)                   |
|                  | settings.py        |                                    |
| 모델 코딩하기    | models.py          | owner 필드 추가                    |
|                  | admin.py           | (변경 사항 없음)                   |
|                  | makemigrations     | 변경 사항을 데이터베이스에 반영    |
|                  | migrate            |                                    |
| URLconf 코딩하기 | urls.py            | URL 정의                           |
| 뷰 코딩하기      | views.py           | 뷰 로직 작성                       |
| 템플릿 코딩하기  | templates 디렉터리 | 템플릿 파일 작성                   |
| 그 외 코딩하기   | static 디렉터리    | 테이블 모양 정의를 base.css에 추가 |

