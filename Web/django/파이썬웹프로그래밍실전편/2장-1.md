Django 실전편 2장

# 1. 애플리케이션 설계하기

화면 UI 설계
- bookmark list, bookmark detail

테이블 설계
- id, title, url

로직, url 설계

| URL 패턴       | 뷰 이름                | 템플릿 파일 이름     |
|----------------|------------------------|----------------------|
| /bookmark/     | BookmarkLV(ListView)   | bookmark_list.html   |
| /bookmark/99/* | BookmarkDV(DetailView) | bookmark_detail.html |
| /admin/        | (Django 기제공 기능)   |                      |

코딩 순서
- 테이블 정의
- URL, 뷰, 템플릿

# 2. 개발 코딩하기 - 뼈대

프로젝트 생성
>> django-admin startproject mysite

프로젝트 설정 파일 변경
- settings.py 파일에서 다음 6가지를 확인한다.
- Database
- Templates, 템플릿 파일을 찾을 때, 프로젝트 템플릿 디렉터리를 검색하고 앱 템플릿 디렉터리를 검색함.
- 정적 파일, 검색 순서는 템플릿과 동일함
- 타임존
- 미디어
- 앱 등록

기본 테이블 생성
>> python manage.py migrate
- 사용자 및 권한 그룹 테이블은 기본 제공된다.

슈퍼유저 생성
>> python manage.py createsuperuser

앱 생성
>> python manage.py startapp bookmark

앱 등록
- settings.py 파일에 INSTALLED_APPS에 추가하기
- 앱 모듈명인 'bookmark'로 등록하는 것 보단
- 앱의 설정 클래스명인 'bookmark.apps.BookmarkConfig' 등록하는 것이 더 정확함

# 3. 개발 코딩하기 - 모델

데이터베이스에 테이블을 생성하도록 해주는 작업임

테이블 정의 - pyDjango/ch2/bookmark/models.py
```buildoutcfg
from django.db import models

# Create your models here.
class Bookmark(models.Model):
    title = models.CharField(max_length=100, blank=True, null=True)
    url = models.URLField('url', unique=True)

    def __str__(self):
        return self.title
```
- title은 blank(공백) 값을 가질 수도 있고, 값이 없을(null)수도 있음
- URLField() 필드 클래스의 첫 번째 파라미터인 'url'은 url 컬럼에 대한 레이블 문구임, 필드의 별칭
- \_\_str\_\_() 함수는 객체를 문자열로 표현하는 함수임 Admin 사이트에서 어떻게 보일지 결정함

Admin 사이트에 테이블 반영
- 방금 만든 model을 Admin 사이트에서 볼 수 있도록 설정함

bookmark/admin.py
```buildoutcfg
from django.contrib import admin
from .models import Bookmark
# Register your models here.


class BookmarkAdmin(admin.ModelAdmin):
    list_display = ('title', 'url')


admin.site.register(Bookmark, BookmarkAdmin)
```
- admin.site.register(Bookmark, BookmarkAdmin)에서 파라미터 2개 입력함 하나씩 확인 해봄
- 첫번째 파라미터는 모델 명, 두번째 파라미터는 모델이 어떻게 보일지 설정한 클래스임
- list_display를 통해 title, url을 화면에 출력하라고 지정함
- 테이블을 새로 만들 때는 models.py와 admin.py 두 개의 파일을 함께 수정해야함

데이터베이스 변경 사항 반영하기
- 데이터베이스를 변경하고 이를 실제로 반영해주는 작업임
>> python manage.py makemigrations<br>python manage.py migrate

- python manage.py makemigrations 명령을 통해 변경 사항을 {{appname}}/migrations에 저장함

bookmark/migrations/0001_initial.py
```buildoutcfg
# Generated by Django 2.1.4 on 2019-02-18 13:30

from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
    ]

    operations = [
        migrations.CreateModel(
            name='Bookmark',
            fields=[
                ('id', models.AutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('title', models.CharField(blank=True, max_length=100, null=True)),
                ('url', models.URLField(unique=True, verbose_name='url')),
            ],
        ),
    ]

```

- python manage.py migrate 명령을 통해 변경사항을 반영함

테이블 확인하기
>> python manage.py runserver
- 위 명령어로 기본 제공되는 runserver를 실행하고 127.0.0.1/admin에 접속함
- createsuperuser 명령어로 만든 superuser로 로그인하고 admin 사이트 확인

제멋대로인 Admin 사이트의 이름 표기 방식
- 앱명: startapp appname 명령 시 사용한 appname을 대문자로 표시함
- 테이블명: 아래 객체명에 복수형 접미사(s)를 추가하고 첫글자를 대문자로 표시함
ex) 클래스명이 MyCooky라면 테이블명은 My cookys가 됨
이는 verbose_name_plural 메타 옵션으로 변경 가능
- 객체명: models.py 파일에 정의한 모델 클래스 이름을 소문자와 공백으로 바꿈
ex) 모델 클래스명이 MyCooky라면 my cooky가 됨 verbose_name 메타 옵션으로 지정 가능

